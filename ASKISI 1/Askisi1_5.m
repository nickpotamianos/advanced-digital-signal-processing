% ------------------------------------------------------------
% Υλοποίηση Pisarenko (P = 1)
% Υπολογισμός πλάτους, συχνότητας και διασποράς λευκού θορύβου
% ------------------------------------------------------------

% Μητρώο αυτοσυσχέτισης (R_xx) της άσκησης
Rxx = [ 3          2*(1-1j) ;
        2*(1+1j)   3        ];

% 1) Ιδιοανάλυση
[U,lambda_vec] = eig(Rxx,'vector');   % U: ιδιοδιανύσματα  λambda_vec: ιδιοτιμές

% 2) Ταυτοποίηση μέγιστης/ελάχιστης ιδιοτιμής
[lambda_max, idx_max] = max(lambda_vec);
[lambda_min, ~      ] = min(lambda_vec);

% 3) Διασπορά θορύβου
sigma2_W = lambda_min;

% 4) Πλάτος σήματος |A|  (Μ = 2 για μητρώο 2×2)
M  = size(Rxx,1);
A_abs = sqrt( (lambda_max - lambda_min)/M );

% 5) Συχνότητα ω  (από τον λόγο των στοιχείων του ιδιοδιανύσματος λ_max)
u_max = U(:,idx_max);          % ιδιοδιάνυσμα αντιστοιχίας λ_max
omega = -angle( u_max(1) / u_max(2) );   % rad/δείγμα

% 6) Εμφάνιση αποτελεσμάτων (σε δεκαδική και κλειστή μορφή)
fprintf('Πλάτος |A|      = %10.6f\n', A_abs);
fprintf('Συχνότητα ω     = %10.6f rad/δείγμα\n', mod(omega,2*pi));
fprintf('Διασπορά σ_ω²    = %10.6f\n', sigma2_W);

% Προαιρετικά: εμφάνιση ιδιοτιμών για έλεγχο
disp(table(lambda_vec,'VariableNames',{'Eigenvalues'}));
